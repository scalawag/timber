<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Messages &middot; timber
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/timber/public/css/poole.css">
  <link rel="stylesheet" href="/timber/public/css/syntax.css">
  <link rel="stylesheet" href="/timber/public/css/hyde.css">
  <link rel="stylesheet" href="/timber/public/css/custom.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <!-- <link rel="shortcut icon" href="/timberpublic/favicon.ico"> -->

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <div class="sidebar">
  <div class="container">
    <div class="sidebar-about">
      <h1>
        timber
      </h1>
      <p class="lead"></p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/timber">Home</a>

      

      
      

      
        
        
          
            
              
                <a class="sidebar-nav-item" href="/timber/Concepts">Concepts</a>
              
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
        
        <hr/>
      
        timber-api
        
          
            
          
        
          
            
              
                <a class="sidebar-nav-item" href="/timber/timber-api/GettingStarted">Getting Started</a>
              
            
          
        
          
            
          
        
          
            
          
        
          
            
              
                <a class="sidebar-nav-item" href="/timber/timber-api/Loggers">Loggers</a>
              
            
          
        
          
            
          
        
          
            
              
                <a class="sidebar-nav-item active" href="/timber/timber-api/Messages">Messages</a>
              
            
          
        
          
            
          
        
          
            
              
                <a class="sidebar-nav-item" href="/timber/timber-api/Levels">Levels</a>
              
            
          
        
          
            
          
        
          
            
              
                <a class="sidebar-nav-item" href="/timber/timber-api/ThreadAttributes">Thread Attributes</a>
              
            
          
        
          
            
          
        
          
            
          
        
          
            
              
                <a class="sidebar-nav-item" href="/timber/timber-api/BestPractices">Best Practices</a>
              
            
          
        
          
            
              
                <a class="sidebar-nav-item" href="/timber/timber-api/AdvancedUsage">Advanced Usage</a>
              
            
          
        
          
        
        <hr/>
      
        timber-backend
        
          
            
          
        
          
            
          
        
          
            
              
                <a class="sidebar-nav-item" href="/timber/timber-backend/GettingStarted">Getting Started</a>
              
            
          
        
          
            
              
                <a class="sidebar-nav-item" href="/timber/timber-backend/Dispatchers">Dispatchers</a>
              
            
          
        
          
            
          
        
          
            
              
                <a class="sidebar-nav-item" href="/timber/timber-backend/ConfigurationDSL">Configuration DSL</a>
              
            
          
        
          
            
          
        
          
            
              
                <a class="sidebar-nav-item" href="/timber/timber-backend/Conditions">Conditions</a>
              
            
          
        
          
            
          
        
          
            
              
                <a class="sidebar-nav-item" href="/timber/timber-backend/Entries">Entries</a>
              
            
          
        
          
            
          
        
          
            
              
                <a class="sidebar-nav-item" href="/timber/timber-backend/Formatters">Formatters</a>
              
            
          
        
          
            
              
                <a class="sidebar-nav-item" href="/timber/timber-backend/Receivers">Receivers</a>
              
            
          
        
          
            
          
        
          
            
          
        
          
        
        <hr/>
      

      <a class="sidebar-nav-item" href="https://github.com/scalawag/timber">View on GitHub</a>
<!--      <a class="sidebar-nav-item" href="https://github.com/scalawag/timber/archive/v0.6.0-SNAPSHOT.zip">Download</a> -->
      <span class="sidebar-nav-item">Currently v0.6.0-SNAPSHOT</span>
    </nav>

    <p>&copy; 2016</p>
  </div>
</div>


    <div class="content container">
      <div class="page">
  <h1 class="page-title">Messages</h1>
  <p>Messages provide the text content for entries in the logging system. This is one of the areas where timber attempts
to improve upon the classic JVM application logging interfaces (starting with log4j) by taking advantage of
Scala’s language features.</p>

<p>Internally, each message is an object that produces the text (as a <code class="highlighter-rouge">String</code>) lazily on demand.  The work of creating
the message isn’t performed until it’s needed, either because the filtering rules require it or because it’s being
sent to a log file or bridged to another logging system.  As a user of the timber API, you will hopefully remain
blissfully unaware of the existence of the <code class="highlighter-rouge">Message</code> class. You normally won’t create one explicitly but will use
one of the implicit conversions in the <code class="highlighter-rouge">Message</code> companion object.  This is now known as the
<a href="http://spray.io/blog/2012-12-13-the-magnet-pattern/">Magnet Pattern</a>.</p>

<p>Because of the lazy nature of messages, timber loggers don’t support the <code class="highlighter-rouge">isEnabled()</code> style methods common to most
JVM logging systems.  That’s because you don’t need to guard against unnecessary and expensive string-building code.
Timber will compute the string value exactly once the first time that it’s required.</p>

<h2 id="string">String</h2>

<p>The simplest case is where an expression returning a <code class="highlighter-rouge">String</code> is used as the message.  The string is converted by-name,
which means that even though it may look like you’re wasting cycles generating a string when it’s not being logged,
you’re not.  Scala makes it so that no work is done unless it’s required.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// A simple String literal
</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="o">(</span><span class="s">"my simple message"</span><span class="o">)</span>

<span class="c1">// A simple String expression
</span><span class="k">val</span> <span class="n">simple</span> <span class="k">=</span> <span class="kc">true</span>
<span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="o">(</span><span class="s">"my "</span> <span class="o">+</span> <span class="o">(</span> <span class="k">if</span> <span class="o">(</span> <span class="n">simple</span> <span class="o">)</span> <span class="s">"simple"</span> <span class="k">else</span> <span class="s">"complex"</span> <span class="o">)</span> <span class="o">+</span> <span class="s">" message"</span><span class="o">)</span>

<span class="c1">// A thunk that returns a String
</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">adjective</span> <span class="k">=</span>
    <span class="k">if</span> <span class="o">(</span> <span class="n">simple</span> <span class="o">)</span>
      <span class="s">"simple"</span>
    <span class="k">else</span>
      <span class="s">"complex"</span>
  <span class="s">"my "</span> <span class="o">+</span> <span class="n">adjective</span> <span class="o">+</span> <span class="s">" message"</span>
<span class="o">}</span>

<span class="c1">// An interpolated string
</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="o">(</span><span class="n">s</span><span class="s">"my ${ if ( simple ) "</span><span class="n">simple</span><span class="s">" else "</span><span class="n">complex</span><span class="s">" } message"</span><span class="o">)</span>
</code></pre>
</div>

<p>These calls all produce the same message and they’re all lazy.</p>

<h2 id="throwable">Throwable</h2>

<p>Timber takes a different approach to <code class="highlighter-rouge">Throwable</code> stack traces than most other logging systems.  There is no special
handling for throwables in log entries.  As far as timber is concerned, stack traces are just another source of text
for an entry and that’s all.  If all the text that you want to log is the stack trace of a throwable, you can just use
the throwable directly as your message and it will be converted into a message containing its stack trace.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
  <span class="k">throw</span> <span class="k">new</span> <span class="nc">Exception</span><span class="o">(</span><span class="s">"boom!"</span><span class="o">)</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">{</span>
  <span class="k">case</span> <span class="n">ex</span><span class="k">:</span> <span class="kt">Exception</span> <span class="o">=&gt;</span> <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="o">(</span><span class="n">ex</span><span class="o">)</span>
<span class="o">}</span>
</code></pre>
</div>

<p>Of course, the work of producing the stack trace won’t be done unless it turns out that the message text is needed.</p>

<h2 id="stringthrowable">(String,Throwable)</h2>

<p>With some other logging systems, like log4j, you can include a message along with your throwable’s stack trace by
including both a message <em>and</em> a throwable in the logging call.  With timber, there is a tuple conversion that allows
you to do the same thing.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
  <span class="k">throw</span> <span class="k">new</span> <span class="nc">Exception</span><span class="o">(</span><span class="s">"boom!"</span><span class="o">)</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">{</span>
  <span class="k">case</span> <span class="n">ex</span><span class="k">:</span> <span class="kt">Exception</span> <span class="o">=&gt;</span> <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="o">(</span><span class="s">"I caught an exception!"</span><span class="o">,</span><span class="n">ex</span><span class="o">)</span>
<span class="o">}</span>
</code></pre>
</div>

<p>The resulting message will contain the line “I caught an exception!” followed by the output of <code class="highlighter-rouge">ex.printStackTrace</code>
on the lines that follow.</p>

<h2 id="printwriter--unit">PrintWriter =&gt; Unit</h2>

<p>Sometimes, it may be easier for you to use a <code class="highlighter-rouge">PrintWriter</code> to add multiple lines of text to the log entry. Even if
it’s not really easier, it’s a good idea because it will keep the lines of the entry together. Timber always treats
an entry as an indivisible unit, even if it has multiple lines.  This means that it won’t be split across multiple
files (for rolling configurations) or broken up by another thread’s entry.</p>

<p>This can be broken up because it generates eleven entries.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">val</span> <span class="n">nums</span> <span class="k">=</span> <span class="nc">Stream</span><span class="o">.</span><span class="n">from</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="n">take</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>

<span class="n">pw</span><span class="o">.</span><span class="n">println</span><span class="o">(</span><span class="s">"Some kind of heading:"</span><span class="o">)</span>
<span class="n">nums</span> <span class="n">foreach</span> <span class="o">{</span> <span class="n">n</span> <span class="k">=&gt;</span>
  <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="o">(</span><span class="n">n</span><span class="o">.</span><span class="n">toString</span><span class="o">)</span>
<span class="o">}</span>
</code></pre>
</div>

<p>This is better style (timber-wise) because it produces one multi-line entry.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">val</span> <span class="n">nums</span> <span class="k">=</span> <span class="nc">Stream</span><span class="o">.</span><span class="n">from</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="n">take</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>

<span class="n">log</span><span class="o">.</span><span class="n">debug</span> <span class="o">{</span> <span class="n">pw</span><span class="k">:</span><span class="kt">PrintWriter</span> <span class="o">=&gt;</span>
  <span class="n">pw</span><span class="o">.</span><span class="n">println</span><span class="o">(</span><span class="s">"Some kind of heading:"</span><span class="o">)</span>
  <span class="n">nums</span> <span class="n">foreach</span> <span class="n">pw</span><span class="o">.</span><span class="n">println</span>
<span class="o">}</span>
</code></pre>
</div>

<p>Note that you have to explicitly type the argument to your function literal as a <code class="highlighter-rouge">PrintWriter</code> or else timber (more
specifically, Scala) won’t understand what you’re trying to do.</p>

<p>It may not be worth repeating but I’ll repeat it anyway – none of this work happens (including the creation of the
<code class="highlighter-rouge">PrintWriter</code>) unless the message text proves to be necessary.</p>

<h2 id="immediatemessage">ImmediateMessage</h2>

<p>After all this talk of lazy message calculation, it’s important to point out that there are some situations where this
is undesirable behavior. If you have entries with messages that are built out of <code class="highlighter-rouge">var</code>s whose values may change by
the time the entry eventually makes it to its destination, you probably want to capture their value at the time of
logging. You can indicate this to a logger by adding the <code class="highlighter-rouge">ImmediateMessage</code> tag to the entry. (This is the only
tag that has any significance to timber.)  It tells the logger to calculate the message text synchronously during the
logging call.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="n">name</span> <span class="k">=</span> <span class="s">"alice"</span>
<span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="o">(</span><span class="nc">Set</span><span class="o">(</span><span class="nc">ImmediateMessage</span><span class="o">))(</span><span class="n">s</span><span class="s">"sending to $name"</span><span class="o">)</span>
<span class="n">name</span> <span class="k">=</span> <span class="s">"bob"</span>
</code></pre>
</div>

<p>If you add the <code class="highlighter-rouge">ImmediateMessage</code> tag to a <em>logger</em>, it makes it so that all of that logger’s entry’s messages are
calculated immediately.  There may be situations where this is warranted.</p>

<h2 id="next-steps">Next Steps</h2>

<ul>
  <li>Learn about timber’s <a href="Levels">levels</a>.</li>
</ul>

</div>

<a class="help" href="https://github.com/scalawag/timber/edit/develop/src/jekyll/api/03-Messages.md">
  Help improve this page.
</a>

    </div>

  </body>
</html>
